(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1036:function(e,t,a){},1038:function(e,t,a){},1050:function(e,t,a){},613:function(e,t,a){"use strict";a.r(t);var n=a(30),i=(a(84),a(24)),r=(a(1353),a(1352)),l=(a(361),a(80)),o=(a(358),a(169)),s=(a(165),a(92)),c=a(25),u=a(26),h=a(29),p=a(27),f=a(28),m=(a(366),a(78)),d=(a(365),a(114)),g=(a(167),a(56)),v=a(1),y=a.n(v),E=a(98),b=a(113),C=(a(879),a(887),a(993),a(1036),a(89)),k=(a(1038),a(4)),w=a.n(k),_=a(1040),x=a.n(_),I=a(1041);I.registerLanguage("css",a(1042)),I.registerLanguage("json",a(1043)),I.registerLanguage("less",a(1044)),I.registerLanguage("scss",a(1045)),I.registerLanguage("javascript",a(1046)),I.registerLanguage("typescript",a(1047));var N=I;x.a.setOptions({renderer:new x.a.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(e){return N.highlightAuto(e).value}});var j=new x.a.Renderer;j.paragraph=function(e){return"<p>".concat(e,"</p>")},j.link=function(e,t,a){return"<a href=".concat(e,"\n      title=").concat(t||e,"\n      target='_blank'\n      }>").concat(a,"</a>")};var O=function(e){return"string"!=typeof e?"":x()(e,{renderer:j})};function S(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=e.value;if(e.selectionStart||0===e.selectionStart){var r=e.selectionStart,l=e.selectionEnd,o=e.scrollTop;r===l?(e.value=i.substring(0,r)+t+a+n+i.substring(l,i.length),e.selectionStart=r+t.length,e.selectionEnd=l+t.length+a.length):(e.value=i.substring(0,r)+t+i.substring(r,l)+n+i.substring(l,i.length),e.selectionStart=r+t.length,e.selectionEnd=l+t.length),e.focus(),o>=0&&(e.scrollTop=o)}}var T={h1:function(e){S(e,"# ","\u4e00\u7ea7\u6807\u9898")},h2:function(e){S(e,"## ","\u4e8c\u7ea7\u6807\u9898")},h3:function(e){S(e,"### ","\u4e09\u7ea7\u6807\u9898")},h4:function(e){S(e,"#### ","\u56db\u7ea7\u6807\u9898")},image:function(e){S(e,"![alt](","url",")")},link:function(e){S(e,"[title](","url",")")},code:function(e){S(e,"```","language","\n\n```")},tab:function(e){S(e,"  ")}},A=function(e,t){return T[t](e)},L=83,D=90,M=89,H=9,R=(a(1048),a(1050),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;a.saveHistory(t),a.props.onChange(t)},a.insert=function(e){var t=Object(C.a)(a).$vm,n=e.currentTarget?e.currentTarget.getAttribute("data-type"):e;A(t,n),a.props.onChange(t.value),a.saveHistory(t.value)},a.undo=function(){var e=a.state.f_history,t=a.state.f_history_index;if(!((t-=1)<0)){a.setState({f_history_index:t});var n=e[t];a.props.onChange(n),a.handleLineIndex(n)}},a.redo=function(){var e=a.state.f_history,t=a.state.f_history_index;if(!((t+=1)>=e.length)){a.setState({f_history_index:t});var n=e[t];a.props.onChange(n),a.handleLineIndex(n)}},a.preview=function(){a.setState({preview:!a.state.preview})},a.expand=function(){a.setState({expand:!a.state.expand})},a.save=function(){a.props.onSave()},a.focusText=function(){Object(C.a)(a).$vm.focus()},a.getMarkedHtml=function(){var e=a.props.value;return O(e)},a.$vm=null,a.handleEditorRef=function(e){a.$vm=e},a.state={preview:!1,expand:!1,f_history:[],f_history_index:0,line_index:1},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e;(e=this).$vm.addEventListener("keydown",function(t){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey){if((t.ctrlKey||t.metaKey)&&!t.altKey&&!t.shiftKey)switch(t.keyCode){case D:t.preventDefault(),e.undo();break;case M:t.preventDefault(),e.redo();break;case L:t.preventDefault(),e.save()}}else switch(t.keyCode){case H:t.preventDefault(),e.insert("tab")}})}},{key:"componentWillUpdate",value:function(e,t){var a=this.state.f_history;e.value&&0===t.f_history.length&&(a.push(e.value),this.setState({f_history:a}),this.handleLineIndex(e.value))}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.handleLineIndex(e.value)}},{key:"saveHistory",value:function(e){var t=this,a=this.state,n=a.f_history,i=a.f_history_index;window.clearTimeout(this.currentTimeout),this.currentTimeout=setTimeout(function(){i<n.length-1&&n.splice(i+1),n.length>=20&&n.shift(),i=n.length,n.push(e),t.setState({f_history:n,f_history_index:i})},500),this.handleLineIndex(e)}},{key:"handleLineIndex",value:function(e){var t=e?e.split("\n").length:1;this.setState({line_index:t})}},{key:"render",value:function(){var e=this.state,t=e.preview,a=e.expand,n=e.line_index,i=this.props.value;console.log("markValue",this.props);var r=w()({"for-panel":!0,"for-preview-hidden":!t}),l=w()({"for-panel":!0}),o=w()({"for-active":t}),s=w()({"for-container":!0,"for-fullscreen":a}),c=w()({"for-active":a}),u=w()({"for-line-num":!0,hidden:!this.props.lineNum}),h="";try{t&&(h=O(i))}catch(p){console.log(p)}return y.a.createElement("div",{className:s,style:{height:this.props.height}},y.a.createElement("div",{className:"for-controlbar"},y.a.createElement("ul",null,y.a.createElement("li",{onClick:this.undo,title:"\u4e0a\u4e00\u6b65 (ctrl+z)"},y.a.createElement("i",{className:"foricon for-undo"})),y.a.createElement("li",{onClick:this.redo,title:"\u4e0b\u4e00\u6b65 (ctrl+y)"},y.a.createElement("i",{className:"foricon for-redo"})),y.a.createElement("li",{"data-type":"h1",onClick:this.insert,title:"\u4e00\u7ea7\u6807\u9898"},"H1"),y.a.createElement("li",{"data-type":"h2",onClick:this.insert,title:"\u4e8c\u7ea7\u6807\u9898"},"H2"),y.a.createElement("li",{"data-type":"h3",onClick:this.insert,title:"\u4e09\u7ea7\u6807\u9898"},"H3"),y.a.createElement("li",{"data-type":"h4",onClick:this.insert,title:"\u56db\u7ea7\u6807\u9898"},"H4"),y.a.createElement("li",{"data-type":"image",onClick:this.insert,title:"\u56fe\u7247"},y.a.createElement("i",{className:"foricon for-image"})),y.a.createElement("li",{"data-type":"link",onClick:this.insert,title:"\u8d85\u94fe\u63a5"},y.a.createElement("i",{className:"foricon for-link"})),y.a.createElement("li",{"data-type":"code",onClick:this.insert,title:"\u4ee3\u7801\u5757"},y.a.createElement("i",{className:"foricon for-code"}))),y.a.createElement("ul",null,y.a.createElement("li",{className:c,onClick:this.expand},c?y.a.createElement("i",{className:"foricon for-contract"}):y.a.createElement("i",{className:"foricon for-expand"})),y.a.createElement("li",{className:o,onClick:this.preview},o?y.a.createElement("i",{className:"foricon for-eye-off"}):y.a.createElement("i",{className:"foricon for-eye"})))),y.a.createElement("div",{className:"for-editor"},y.a.createElement("div",{className:l,tabIndex:"-1",onFocus:this.focusText},y.a.createElement("div",{className:"for-editor-wrapper"},y.a.createElement("div",{className:"for-editor-block"},function(){for(var e=[],t=0;t<n;t++)e.push(y.a.createElement("li",{key:t+1},t+1));return y.a.createElement("ul",{className:u},e)}(),y.a.createElement("div",{className:"for-editor-content"},y.a.createElement("pre",null,i," "),y.a.createElement("textarea",{ref:this.handleEditorRef,value:i,onChange:this.handleChange,placeholder:this.props.placeholder}))))),y.a.createElement("div",{className:r},y.a.createElement("div",{className:"for-preview for-markdown-preview",dangerouslySetInnerHTML:{__html:h}}))))}}]),t}(y.a.Component));R.defaultProps={placeholder:"\u8bf7\u8f93\u5165\u5185\u5bb9...",lineNum:!0};var V=R,K=a(162),Y=a(3),$=a.n(Y),F=g.a.Option,W=d.a.Group,q=m.a.Group,z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={},a.handleSubmit=function(e){e.preventDefault();var t=Object.assign({},a.props.article.singleArticle),n=a.markdownRef.current.getMarkedHtml();t.content=n,t.date=t.date._d,console.log("article",t);var i=t.date.getMonth()+1,r=t.date.getDate();i>=1&&i<=9&&(i="0"+i),r>=0&&r<=9&&(r="0"+r),t.create_time=t.date.getFullYear()+"-"+i+"-"+r+" "+t.date.getHours()+":"+t.date.getMinutes()+":"+t.date.getSeconds(),t.type="post",console.log("article",t),t.id?Object(K.a)(t,t.id).then(function(e){0==e.errno&&e.data.id&&s.a.success("\u4fee\u6539\u6210\u529f!").then(function(){a.props.history.push("/article/table")})}):Object(K.a)(t).then(function(e){console.log("res",e),e.id&&s.a.success("\u65b0\u589e\u6210\u529f!").then(function(){a.props.history.push("/article/table")})})},a.onChangeStatus=function(e){e.preventDefault()},a.onChangeInput=function(e,t){var n={};n[e]=t.target.value,a.props.changeArticle(n)},a.onChangeDate=function(e){a.props.changeArticle({date:e})},a.onChangeTags=function(e){var t=e;console.log("tags",t),a.props.changeArticle({tag:t})},a.onChangeCate=function(e){a.props.changeArticle({category_id:e})},a.onChangeMarkdown=function(e){a.props.changeArticle({markdown:e})},a.markdownRef=y.a.createRef(),a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.props.fetchTags({type:"tag"})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;console.log("this.props",this.props);var t=this.props.form.getFieldDecorator,a=this.props.tag.map(function(e){return e.id}),n=this.props.tags.map(function(e){return{label:e.name,value:e.id}});return y.a.createElement("div",null,y.a.createElement(l.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},{className:"editForm",onSubmit:this.handleSubmit}),y.a.createElement(l.a.Item,{label:"\u6587\u7ae0\u6807\u9898"},t("title",{initialValue:this.props.title,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}]})(y.a.createElement(o.a,{placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u9898",autoComplete:"off",onChange:function(t){e.onChangeInput("title",t)}}))),y.a.createElement(l.a.Item,{label:"\u6587\u7ae0\u6807\u793a"},t("sign",{initialValue:this.props.sign})(y.a.createElement(o.a,{placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u793a",autoComplete:"off",onChange:function(t){e.onChangeInput("sign",t)}}))),y.a.createElement(l.a.Item,{label:"\u7f29\u7565\u56fe"},t("thumb",{initialValue:this.props.thumb})(y.a.createElement(o.a,{placeholder:"\u8bf7\u8f93\u5165",autoComplete:"off",onChange:function(t){e.onChangeInput("thumb",t)}}))),y.a.createElement(l.a.Item,{label:"\u53d1\u5e03\u65f6\u95f4"},t("date",{initialValue:this.props.createTime?$()(new Date(1e3*this.props.createTime),"YYYY-MM"):null})(y.a.createElement(r.a,{onChange:function(t){e.onChangeDate(t)}}))),y.a.createElement(l.a.Item,{label:"\u6587\u7ae0\u5206\u7c7b"},t("category_id",{initialValue:this.props.categoryId})(y.a.createElement(g.a,{onChange:this.onChangeCate},y.a.createElement(F,{value:1},"tech"),y.a.createElement(F,{value:2},"life")))),y.a.createElement(l.a.Item,{label:"\u72b6\u6001"},t("status",{initialValue:this.props.status,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6587\u7ae0\u72b6\u6001"}]})(y.a.createElement(W,{onChange:function(t){e.onChangeInput("status",t)}},y.a.createElement(d.a,{value:0},"\u8349\u7a3f"),y.a.createElement(d.a,{value:99},"\u53d1\u5e03")))),y.a.createElement(l.a.Item,{label:"\u6807\u7b7e"},t("tag",{initialValue:a})(y.a.createElement(q,{options:n,onChange:this.onChangeTags}))),y.a.createElement(l.a.Item,{label:"\u6587\u7ae0\u5185\u5bb9"},t("markdown",{initialValue:this.props.markdown})(y.a.createElement(V,{onChange:this.onChangeMarkdown,ref:this.markdownRef}))),y.a.createElement(l.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},y.a.createElement(i.a,{type:"primary",htmlType:"submit"},"\u786e\u5b9a"))))}}]),t}(y.a.Component),G=l.a.create({name:"edit-form"})(z),J=Object(E.b)(function(e){return{title:e.article.singleArticle.title,sign:e.article.singleArticle.sign,thumb:e.article.singleArticle.thumb,date:e.article.singleArticle.date,status:e.article.singleArticle.status,tag:e.article.singleArticle.tag,article:e.article,tags:e.article.tags,categoryId:e.article.singleArticle.category_id,createTime:e.article.singleArticle.create_time,markdown:e.article.singleArticle.markdown}},function(e){return{changeArticle:function(t){e(Object(b.a)(t))},articleClear:function(t){e(Object(b.b)(t))},fetchTags:function(t){e(Object(b.d)(Object(n.a)({},t)))}}});t.default=J(G)}}]);